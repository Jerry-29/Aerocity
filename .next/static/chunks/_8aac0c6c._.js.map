{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/api-client.ts"],"sourcesContent":["// lib/api-client.ts - API client utility for frontend\r\nimport { ValidationResult } from \"./validators\";\r\n\r\nexport interface ApiError {\r\n  success: false;\r\n  message: string;\r\n  error: string;\r\n  code?: string;\r\n}\r\n\r\nexport interface ApiSuccess<T> {\r\n  success: true;\r\n  message: string;\r\n  data: T;\r\n}\r\n\r\nexport interface ApiPaginated<T> {\r\n  success: true;\r\n  message?: string;\r\n  data: T[];\r\n  pagination: {\r\n    currentPage: number;\r\n    pageSize: number;\r\n    totalElements: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrevious: boolean;\r\n  };\r\n}\r\n\r\nexport type ApiResponse<T> = ApiSuccess<T> | ApiError;\r\n\r\n/**\r\n * Fetch wrapper with auth token handling\r\n */\r\nasync function fetchWithAuth(\n  url: string,\n  options: RequestInit = {},\n): Promise<Response> {\n  const token = getAuthToken();\r\n\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    ...options.headers,\r\n    ...(token && { Authorization: `Bearer ${token}` }),\r\n  };\r\n\r\n  const response = await fetch(url, {\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  // If unauthorized, clear token\n  if (response.status === 401) {\n    clearAuthToken();\n    if (typeof window !== \"undefined\") {\n      const isOnLoginPage = window.location.pathname === \"/login\";\n      if (!isOnLoginPage) {\n        window.location.href = \"/login\";\n      }\n    }\n  }\n\r\n  return response;\r\n}\r\n\r\n/**\r\n * Get auth token from localStorage\r\n */\r\nexport function getAuthToken(): string | null {\r\n  if (typeof window === \"undefined\") return null;\r\n  return localStorage.getItem(\"auth_token\");\r\n}\r\n\r\n/**\r\n * Set auth token in localStorage\r\n */\r\nexport function setAuthToken(token: string): void {\r\n  if (typeof window !== \"undefined\") {\r\n    localStorage.setItem(\"auth_token\", token);\r\n  }\r\n}\r\n\r\n/**\r\n * Clear auth token\r\n */\r\nexport function clearAuthToken(): void {\r\n  if (typeof window !== \"undefined\") {\r\n    localStorage.removeItem(\"auth_token\");\r\n  }\r\n}\r\n\r\n/**\r\n * API POST request\r\n */\r\nexport async function apiPost<T>(\r\n  endpoint: string,\r\n  data?: any,\r\n): Promise<ApiResponse<T>> {\r\n  try {\r\n    const response = await fetchWithAuth(endpoint, {\r\n      method: \"POST\",\r\n      body: data ? JSON.stringify(data) : undefined,\r\n    });\r\n\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return json as ApiError;\r\n    }\r\n\r\n    return json as ApiSuccess<T>;\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Network error\",\r\n      error: String(error),\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * API GET request\r\n */\r\nexport async function apiGet<T>(endpoint: string): Promise<ApiResponse<T>> {\r\n  try {\r\n    const response = await fetchWithAuth(endpoint);\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return json as ApiError;\r\n    }\r\n\r\n    return json as ApiSuccess<T>;\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Network error\",\r\n      error: String(error),\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * API GET with pagination\r\n */\r\nexport async function apiGetPaginated<T>(\r\n  endpoint: string,\r\n  page: number = 1,\r\n  limit: number = 10,\r\n): Promise<ApiPaginated<T> | ApiError> {\r\n  try {\r\n    const url = `${endpoint}?page=${page}&limit=${limit}`;\r\n    const response = await fetchWithAuth(url);\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return json as ApiError;\r\n    }\r\n\r\n    return json as ApiPaginated<T>;\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Network error\",\r\n      error: String(error),\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * API PUT request\r\n */\r\nexport async function apiPut<T>(\r\n  endpoint: string,\r\n  data?: any,\r\n): Promise<ApiResponse<T>> {\r\n  try {\r\n    const response = await fetchWithAuth(endpoint, {\r\n      method: \"PUT\",\r\n      body: data ? JSON.stringify(data) : undefined,\r\n    });\r\n\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return json as ApiError;\r\n    }\r\n\r\n    return json as ApiSuccess<T>;\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Network error\",\r\n      error: String(error),\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * API DELETE request\r\n */\r\nexport async function apiDelete<T>(endpoint: string): Promise<ApiResponse<T>> {\r\n  try {\r\n    const response = await fetchWithAuth(endpoint, {\r\n      method: \"DELETE\",\r\n    });\r\n\r\n    const json = await response.json();\r\n\r\n    if (!response.ok) {\r\n      return json as ApiError;\r\n    }\r\n\r\n    return json as ApiSuccess<T>;\r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: \"Network error\",\r\n      error: String(error),\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Check if response is successful\r\n */\r\nexport function isSuccessResponse<T>(\r\n  response: ApiResponse<T>,\r\n): response is ApiSuccess<T> {\r\n  return response.success === true;\r\n}\r\n\r\n/**\r\n * Check if response is paginated\r\n */\r\nexport function isPaginatedResponse<T>(\r\n  response: any,\r\n): response is ApiPaginated<T> {\r\n  return response.success === true && !!response.pagination;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/auth-context.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\n  createContext,\n  useContext,\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  type ReactNode,\n} from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport type { AuthUser } from \"./admin-types\";\nimport {\n  apiPost,\n  apiGet,\n  isSuccessResponse,\n  setAuthToken,\n  clearAuthToken,\n} from \"./api-client\";\n\r\ninterface AuthContextType {\n  user: AuthUser | null;\r\n  token: string | null;\r\n  isLoading: boolean;\r\n  login: (\r\n    type: \"admin\" | \"agent\",\r\n    credentials: { email?: string; mobile?: string; password: string }\r\n  ) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | null>(null);\r\n\r\nexport function useAuth() {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error(\"useAuth must be used within AuthProvider\");\r\n  return ctx;\r\n}\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<AuthUser | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const router = useRouter();\n  const hasCheckedSessionRef = useRef(false);\n\n  // Check session on mount\n  useEffect(() => {\n    // Prevent duplicate session checks in React Strict Mode/dev remounts.\n    if (hasCheckedSessionRef.current) return;\n    hasCheckedSessionRef.current = true;\n\n    // Fast path: reuse in-tab cached session to avoid repeated /api/auth/me calls.\n    if (typeof window !== \"undefined\") {\n      const cached = sessionStorage.getItem(\"aerocity_auth_session\");\n      if (cached) {\n        try {\n          const parsed = JSON.parse(cached) as { user: AuthUser; token: string };\n          if (parsed?.user && parsed?.token) {\n            setUser(parsed.user);\n            setToken(parsed.token);\n            setIsLoading(false);\n            return;\n          }\n        } catch {\n          // Ignore invalid cache and fall back to API check.\n        }\n      }\n    }\n\n    async function checkSession() {\n      const response = await apiGet<{ user: AuthUser; token: string }>(\"/api/auth/me\");\n      if (isSuccessResponse(response)) {\n        setUser(response.data.user);\n        setToken(response.data.token);\n        if (typeof window !== \"undefined\") {\n          sessionStorage.setItem(\n            \"aerocity_auth_session\",\n            JSON.stringify({\n              user: response.data.user,\n              token: response.data.token,\n            }),\n          );\n        }\n      } else {\n        setUser(null);\n        setToken(null);\n        if (typeof window !== \"undefined\") {\n          sessionStorage.removeItem(\"aerocity_auth_session\");\n        }\n      }\n      setIsLoading(false);\n    }\n    checkSession();\n  }, []);\n\n  useEffect(() => {\n    if (token) {\n      setAuthToken(token);\n    } else {\n      clearAuthToken();\n    }\n  }, [token]);\n\n  const login = useCallback(\n    async (\n      type: \"admin\" | \"agent\",\n      credentials: { email?: string; mobile?: string; password: string }\n    ) => {\n      const response = await apiPost<{ user: AuthUser; token: string }>(\"/api/auth/login\", {\n        type,\n        ...credentials,\n      });\n\n      if (!isSuccessResponse(response)) {\n        throw new Error(response.error || response.message || \"Login failed\");\n      }\n\n      setUser(response.data.user);\n      setToken(response.data.token);\n      if (typeof window !== \"undefined\") {\n        sessionStorage.setItem(\n          \"aerocity_auth_session\",\n          JSON.stringify({\n            user: response.data.user,\n            token: response.data.token,\n          }),\n        );\n      }\n\n      router.push(response.data.user.role === \"ADMIN\" ? \"/admin\" : \"/agent\");\n    },\n    [router]\n  );\n\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      await apiPost(\"/api/auth/logout\", {});\r\n    } catch {\r\n      // Continue with logout even if API call fails\r\n    } finally {\n      setUser(null);\n      setToken(null);\n      if (typeof window !== \"undefined\") {\n        sessionStorage.removeItem(\"aerocity_auth_session\");\n      }\n      router.push(\"/login\");\n    }\n  }, [router]);\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, isLoading, login, logout }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/node_modules/.pnpm/next%4015.5.12_react-dom%4019.2.4_react%4019.2.4__react%4019.2.4/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}