{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/db.ts"],"sourcesContent":["// lib/db.ts - Prisma client singleton\r\nimport { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ||\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"query\"] : [],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;;;AACtC;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;KAAQ,GAAG;AAC5D;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD","debugId":null}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/jwt-utils.ts"],"sourcesContent":["// lib/jwt-utils.ts - JWT token utilities\r\nimport jwt from \"jsonwebtoken\";\r\nimport type { SessionUser } from \"./auth\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-jwt-secret-key-must-match-java-backend\";\r\nconst JWT_EXPIRATION = process.env.JWT_EXPIRATION || \"86400\"; // 24 hours\r\n\r\nexport interface TokenPayload {\r\n  userId: number;\r\n  mobile: string;\r\n  role: \"ADMIN\" | \"AGENT\";\r\n  iat?: number;\r\n  exp?: number;\r\n}\r\n\r\n/**\r\n * Generate JWT token\r\n */\r\nexport function generateToken(user: SessionUser): string {\r\n  const payload: TokenPayload = {\r\n    userId: user.id,\r\n    mobile: user.mobile,\r\n    role: user.role,\r\n  };\r\n\r\n  return jwt.sign(payload, JWT_SECRET, {\r\n    expiresIn: parseInt(JWT_EXPIRATION),\r\n    algorithm: \"HS256\",\r\n  });\r\n}\r\n\r\n/**\r\n * Verify and decode JWT token\r\n */\r\nexport function verifyToken(token: string): TokenPayload | null {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET, {\r\n      algorithms: [\"HS256\"],\r\n    }) as TokenPayload;\r\n    return decoded;\r\n  } catch (error) {\r\n    console.error(\"JWT verification failed:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Extract token from Authorization header\r\n */\r\nexport function extractTokenFromHeader(authHeader?: string): string | null {\r\n  if (!authHeader) return null;\r\n\r\n  const parts = authHeader.split(\" \");\r\n  if (parts.length !== 2 || parts[0].toLowerCase() !== \"bearer\") {\r\n    return null;\r\n  }\r\n\r\n  return parts[1];\r\n}\r\n\r\n/**\r\n * Extract claims from token without verification\r\n */\r\nexport function extractClaims(token: string): TokenPayload | null {\r\n  try {\r\n    const decoded = jwt.decode(token) as TokenPayload;\r\n    return decoded;\r\n  } catch (error) {\r\n    console.error(\"Failed to decode token:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Validate token expiration\r\n */\r\nexport function isTokenExpired(token: string): boolean {\r\n  const payload = extractClaims(token);\r\n  if (!payload || !payload.exp) return true;\r\n\r\n  const currentTime = Math.floor(Date.now() / 1000);\r\n  return payload.exp < currentTime;\r\n}\r\n"],"names":[],"mappings":"AAAA,yCAAyC;;;;;;;;;;;;;AACzC;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI,SAAS,WAAW;AAalE,SAAS,cAAc,IAAiB;IAC7C,MAAM,UAAwB;QAC5B,QAAQ,KAAK,EAAE;QACf,QAAQ,KAAK,MAAM;QACnB,MAAM,KAAK,IAAI;IACjB;IAEA,OAAO,2MAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QACnC,WAAW,SAAS;QACpB,WAAW;IACb;AACF;AAKO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,2MAAG,CAAC,MAAM,CAAC,OAAO,YAAY;YAC5C,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;IACT;AACF;AAKO,SAAS,uBAAuB,UAAmB;IACxD,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,QAAQ,WAAW,KAAK,CAAC;IAC/B,IAAI,MAAM,MAAM,KAAK,KAAK,KAAK,CAAC,EAAE,CAAC,WAAW,OAAO,UAAU;QAC7D,OAAO;IACT;IAEA,OAAO,KAAK,CAAC,EAAE;AACjB;AAKO,SAAS,cAAc,KAAa;IACzC,IAAI;QACF,MAAM,UAAU,2MAAG,CAAC,MAAM,CAAC;QAC3B,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO;IACT;AACF;AAKO,SAAS,eAAe,KAAa;IAC1C,MAAM,UAAU,cAAc;IAC9B,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,EAAE,OAAO;IAErC,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;IAC5C,OAAO,QAAQ,GAAG,GAAG;AACvB","debugId":null}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/auth-middleware.ts"],"sourcesContent":["// lib/auth-middleware.ts - API route authentication middleware\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { extractTokenFromHeader, verifyToken } from \"./jwt-utils\";\r\nimport type { SessionUser } from \"./auth\";\r\n\r\nexport interface AuthRequest {\r\n  userId: number;\r\n  mobile: string;\r\n  role: \"ADMIN\" | \"AGENT\";\r\n}\r\n\r\nexport interface AuthenticatedRequest extends NextRequest {\r\n  auth?: AuthRequest;\r\n}\r\n\r\n/**\r\n * Middleware to verify JWT token in API routes\r\n */\r\nexport async function withAuth(\n  request: NextRequest,\n): Promise<{ auth: AuthRequest | null; error: NextResponse | null }> {\n  const authHeader = request.headers.get(\"Authorization\");\n  let token = extractTokenFromHeader(authHeader ?? undefined);\n\n  // Fallback to auth cookie for browser-origin API calls where Authorization\n  // header may not yet be attached from localStorage.\n  if (!token) {\n    const authCookie = request.cookies.get(\"aerocity_auth\")?.value;\n    if (authCookie) {\n      try {\n        const parsed = JSON.parse(authCookie) as { token?: string };\n        if (parsed?.token) {\n          token = parsed.token;\n        }\n      } catch {\n        // Ignore invalid cookie and continue to 401 below.\n      }\n    }\n  }\n\n  if (!token) {\n    return {\n      auth: null,\n      error: NextResponse.json(\n        { error: \"Missing or invalid Authorization header\" },\r\n        { status: 401 },\r\n      ),\r\n    };\r\n  }\r\n\r\n  const payload = verifyToken(token);\r\n  if (!payload) {\r\n    return {\r\n      auth: null,\r\n      error: NextResponse.json(\r\n        { error: \"Invalid or expired token\" },\r\n        { status: 401 },\r\n      ),\r\n    };\r\n  }\r\n\r\n  return {\r\n    auth: {\r\n      userId: payload.userId,\r\n      mobile: payload.mobile,\r\n      role: payload.role,\r\n    },\r\n    error: null,\r\n  };\r\n}\r\n\r\n/**\r\n * Middleware to verify if user has required role\r\n */\r\nexport function withRole(requiredRoles: (\"ADMIN\" | \"AGENT\")[]) {\r\n  return (auth: AuthRequest | null): boolean => {\r\n    if (!auth) return false;\r\n    return requiredRoles.includes(auth.role);\r\n  };\r\n}\r\n\r\n/**\r\n * Create error response\r\n */\r\nexport function errorResponse(\r\n  message: string,\r\n  status: number = 400,\r\n): NextResponse {\r\n  return NextResponse.json({ error: message }, { status });\r\n}\r\n\r\n/**\r\n * Create success response\r\n */\r\nexport function successResponse<T>(\r\n  data: T,\r\n  status: number = 200,\r\n): NextResponse {\r\n  return NextResponse.json(data, { status });\r\n}\r\n"],"names":[],"mappings":"AAAA,+DAA+D;;;;;;;;;;;AAC/D;AACA;;;AAgBO,eAAe,SACpB,OAAoB;IAEpB,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI,QAAQ,IAAA,+IAAsB,EAAC,cAAc;IAEjD,2EAA2E;IAC3E,oDAAoD;IACpD,IAAI,CAAC,OAAO;QACV,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC,kBAAkB;QACzD,IAAI,YAAY;YACd,IAAI;gBACF,MAAM,SAAS,KAAK,KAAK,CAAC;gBAC1B,IAAI,QAAQ,OAAO;oBACjB,QAAQ,OAAO,KAAK;gBACtB;YACF,EAAE,OAAM;YACN,mDAAmD;YACrD;QACF;IACF;IAEA,IAAI,CAAC,OAAO;QACV,OAAO;YACL,MAAM;YACN,OAAO,gRAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0C,GACnD;gBAAE,QAAQ;YAAI;QAElB;IACF;IAEA,MAAM,UAAU,IAAA,oIAAW,EAAC;IAC5B,IAAI,CAAC,SAAS;QACZ,OAAO;YACL,MAAM;YACN,OAAO,gRAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2B,GACpC;gBAAE,QAAQ;YAAI;QAElB;IACF;IAEA,OAAO;QACL,MAAM;YACJ,QAAQ,QAAQ,MAAM;YACtB,QAAQ,QAAQ,MAAM;YACtB,MAAM,QAAQ,IAAI;QACpB;QACA,OAAO;IACT;AACF;AAKO,SAAS,SAAS,aAAoC;IAC3D,OAAO,CAAC;QACN,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,cAAc,QAAQ,CAAC,KAAK,IAAI;IACzC;AACF;AAKO,SAAS,cACd,OAAe,EACf,SAAiB,GAAG;IAEpB,OAAO,gRAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAQ,GAAG;QAAE;IAAO;AACxD;AAKO,SAAS,gBACd,IAAO,EACP,SAAiB,GAAG;IAEpB,OAAO,gRAAY,CAAC,IAAI,CAAC,MAAM;QAAE;IAAO;AAC1C","debugId":null}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/validators.ts"],"sourcesContent":["// lib/validators.ts - Input validation utilities\r\nimport { ValidationError } from \"./errors\";\r\n\r\nexport interface ValidationResult {\r\n  valid: boolean;\r\n  message?: string;\r\n  field?: string;\r\n}\r\n\r\n/**\r\n * Validate email format\r\n */\r\nexport function validateEmail(email: string): boolean {\r\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n  return emailRegex.test(email);\r\n}\r\n\r\n/**\r\n * Validate mobile number (Indian format)\r\n */\r\nexport function validateMobile(mobile: string): boolean {\r\n  // Remove spaces and hyphens\r\n  const cleaned = mobile.replace(/[\\s-]/g, \"\");\r\n  // Accept 10-15 digits\r\n  return /^\\d{10,15}$/.test(cleaned);\r\n}\r\n\r\n/**\r\n * Validate password strength\r\n * Minimum 6 characters\r\n */\r\nexport function validatePassword(password: string): boolean {\r\n  return !!(password && password.length >= 6);\r\n}\r\n\r\n/**\r\n * Validate booking request data\r\n */\r\nexport function validateBookingRequest(data: any): ValidationResult {\r\n  if (!data.visitDate) {\r\n    return { valid: false, message: \"visitDate is required\", field: \"visitDate\" };\r\n  }\r\n\r\n  if (!Array.isArray(data.items) || data.items.length === 0) {\r\n    return {\r\n      valid: false,\r\n      message: \"At least one ticket item is required\",\r\n      field: \"items\",\r\n    };\r\n  }\r\n\r\n  if (!data.customerName || data.customerName.trim().length === 0) {\r\n    return { valid: false, message: \"customerName is required\", field: \"customerName\" };\r\n  }\r\n\r\n  if (!data.customerMobile || !validateMobile(data.customerMobile)) {\r\n    return {\r\n      valid: false,\r\n      message: \"Valid customerMobile is required\",\r\n      field: \"customerMobile\",\r\n    };\r\n  }\r\n\r\n  if (data.customerEmail && !validateEmail(data.customerEmail)) {\n    return { valid: false, message: \"customerEmail must be valid if provided\", field: \"customerEmail\" };\n  }\n\r\n  // Validate booking items\r\n  for (let i = 0; i < data.items.length; i++) {\r\n    const item = data.items[i];\r\n    if (!item.ticketId) {\r\n      return { valid: false, message: `items[${i}].ticketId is required` };\r\n    }\r\n    if (!item.quantity || item.quantity < 1) {\r\n      return { valid: false, message: `items[${i}].quantity must be >= 1` };\r\n    }\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate ticket creation\r\n */\r\nexport function validateTicketRequest(data: any): ValidationResult {\r\n  if (!data.name || data.name.trim().length === 0) {\r\n    return { valid: false, message: \"name is required\", field: \"name\" };\r\n  }\r\n\r\n  if (!data.slug || data.slug.trim().length === 0) {\r\n    return { valid: false, message: \"slug is required\", field: \"slug\" };\r\n  }\r\n\r\n  if (data.customerPrice === undefined || data.customerPrice < 0) {\r\n    return {\r\n      valid: false,\r\n      message: \"customerPrice must be >= 0\",\r\n      field: \"customerPrice\",\r\n    };\r\n  }\r\n\r\n  if (data.agentPrice === undefined || data.agentPrice < 0) {\r\n    return { valid: false, message: \"agentPrice must be >= 0\", field: \"agentPrice\" };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate offer creation\r\n */\r\nexport function validateOfferRequest(data: any): ValidationResult {\r\n  if (!data.name || data.name.trim().length === 0) {\r\n    return { valid: false, message: \"name is required\", field: \"name\" };\r\n  }\r\n\r\n  if (!data.startDate) {\r\n    return { valid: false, message: \"startDate is required\", field: \"startDate\" };\r\n  }\r\n\r\n  if (!data.endDate) {\r\n    return { valid: false, message: \"endDate is required\", field: \"endDate\" };\r\n  }\r\n\r\n  if (new Date(data.startDate) >= new Date(data.endDate)) {\r\n    return {\r\n      valid: false,\r\n      message: \"endDate must be after startDate\",\r\n      field: \"endDate\",\r\n    };\r\n  }\r\n\r\n  if (!Array.isArray(data.offerPrices) || data.offerPrices.length === 0) {\r\n    return {\r\n      valid: false,\r\n      message: \"At least one offer price is required\",\r\n      field: \"offerPrices\",\r\n    };\r\n  }\r\n\r\n  for (let i = 0; i < data.offerPrices.length; i++) {\r\n    const offerPrice = data.offerPrices[i];\r\n    if (!offerPrice.ticketId) {\r\n      return { valid: false, message: `offerPrices[${i}].ticketId is required` };\r\n    }\r\n    if (offerPrice.offerPrice === undefined || offerPrice.offerPrice < 0) {\r\n      return { valid: false, message: `offerPrices[${i}].offerPrice must be >= 0` };\r\n    }\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate login request\r\n */\r\nexport function validateLoginRequest(data: any): ValidationResult {\n  const hasValidMobile = !!data.mobile && validateMobile(data.mobile);\n  const hasValidEmail = !!data.email && validateEmail(data.email);\n\n  if (!hasValidMobile && !hasValidEmail) {\n    return {\n      valid: false,\n      message: \"Valid mobile or email is required\",\n      field: \"mobile\",\n    };\n  }\n\n  if (!data.password) {\n    return { valid: false, message: \"password is required\", field: \"password\" };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate date format (YYYY-MM-DD)\r\n */\r\nexport function validateDateFormat(dateString: string): boolean {\r\n  const dateRegex = /^\\d{4}-\\d{2}-\\d{2}$/;\r\n  if (!dateRegex.test(dateString)) return false;\r\n\r\n  const date = new Date(dateString);\r\n  return date instanceof Date && !isNaN(date.getTime());\r\n}\r\n\r\n/**\r\n * Validate payment verification request\r\n */\r\nexport function validatePaymentVerificationRequest(data: any): ValidationResult {\r\n  if (!data.bookingReference || typeof data.bookingReference !== \"string\") {\r\n    return {\r\n      valid: false,\r\n      message: \"bookingReference is required and must be a string\",\r\n      field: \"bookingReference\",\r\n    };\r\n  }\r\n\r\n  if (!data.razorpayOrderId || typeof data.razorpayOrderId !== \"string\") {\r\n    return {\r\n      valid: false,\r\n      message: \"razorpayOrderId is required and must be a string\",\r\n      field: \"razorpayOrderId\",\r\n    };\r\n  }\r\n\r\n  if (!data.razorpayPaymentId || typeof data.razorpayPaymentId !== \"string\") {\r\n    return {\r\n      valid: false,\r\n      message: \"razorpayPaymentId is required and must be a string\",\r\n      field: \"razorpayPaymentId\",\r\n    };\r\n  }\r\n\r\n  if (!data.razorpaySignature || typeof data.razorpaySignature !== \"string\") {\r\n    return {\r\n      valid: false,\r\n      message: \"razorpaySignature is required and must be a string\",\r\n      field: \"razorpaySignature\",\r\n    };\r\n  }\r\n\r\n  // Amount verification (critical for security)\r\n  if (data.amount === undefined || typeof data.amount !== \"number\" || data.amount <= 0) {\r\n    return {\r\n      valid: false,\r\n      message: \"amount is required, must be a number, and must be > 0\",\r\n      field: \"amount\",\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate testimonial request\r\n */\r\nexport function validateTestimonialRequest(data: any): ValidationResult {\r\n  if (!data.name || data.name.trim().length === 0) {\r\n    return { valid: false, message: \"name is required\", field: \"name\" };\r\n  }\r\n\r\n  if (!data.rating || data.rating < 1 || data.rating > 5) {\r\n    return { valid: false, message: \"rating must be between 1 and 5\", field: \"rating\" };\r\n  }\r\n\r\n  if (!data.content || data.content.trim().length === 0) {\r\n    return { valid: false, message: \"content is required\", field: \"content\" };\r\n  }\r\n\r\n  if (!data.visitDate) {\r\n    return { valid: false, message: \"visitDate is required\", field: \"visitDate\" };\r\n  }\r\n\r\n  if (!validateDateFormat(data.visitDate)) {\r\n    return {\r\n      valid: false,\r\n      message: \"visitDate must be in YYYY-MM-DD format\",\r\n      field: \"visitDate\",\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate announcement request\r\n */\r\nexport function validateAnnouncementRequest(data: any): ValidationResult {\r\n  if (!data.title || data.title.trim().length === 0) {\r\n    return { valid: false, message: \"title is required\", field: \"title\" };\r\n  }\r\n\r\n  if (!data.message && !data.content) {\r\n    return { valid: false, message: \"message is required\", field: \"message\" };\r\n  }\r\n\r\n  if (data.type && ![\"info\", \"warning\", \"notice\"].includes(data.type)) {\r\n    return {\r\n      valid: false,\r\n      message: \"type must be one of: info, warning, notice\",\r\n      field: \"type\",\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate attraction request\r\n */\r\nexport function validateAttractionRequest(data: any): ValidationResult {\r\n  if (!data.title || data.title.trim().length === 0) {\r\n    return { valid: false, message: \"title is required\", field: \"title\" };\r\n  }\r\n\r\n  if (!data.description || data.description.trim().length === 0) {\r\n    return { valid: false, message: \"description is required\", field: \"description\" };\r\n  }\r\n\r\n  if (!data.imageUrl || data.imageUrl.trim().length === 0) {\r\n    return { valid: false, message: \"imageUrl is required\", field: \"imageUrl\" };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate user creation request\r\n */\r\nexport function validateUserCreationRequest(data: any): ValidationResult {\r\n  if (!data.name || data.name.trim().length === 0) {\r\n    return { valid: false, message: \"name is required\", field: \"name\" };\r\n  }\r\n\r\n  if (!data.phone || !validateMobile(data.phone)) {\r\n    return { valid: false, message: \"Valid phone is required\", field: \"phone\" };\r\n  }\r\n\r\n  if (!data.email || !validateEmail(data.email)) {\r\n    return { valid: false, message: \"Valid email is required\", field: \"email\" };\r\n  }\r\n\r\n  if (!data.password) {\r\n    return { valid: false, message: \"password is required\", field: \"password\" };\r\n  }\r\n\r\n  if (!validatePassword(data.password)) {\r\n    return {\r\n      valid: false,\r\n      message: \"password must be at least 6 characters\",\r\n      field: \"password\",\r\n    };\r\n  }\r\n\r\n  if (data.role && ![\"ADMIN\", \"AGENT\"].includes(data.role)) {\r\n    return {\r\n      valid: false,\r\n      message: \"role must be ADMIN or AGENT\",\r\n      field: \"role\",\r\n    };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * Validate user status update request\r\n */\r\nexport function validateUserStatusUpdateRequest(data: any): ValidationResult {\r\n  // At least one field should be provided\r\n  if (!data.name && !data.email && !data.mobile && !data.status) {\r\n    return { valid: false, message: \"At least one field must be provided for update\" };\r\n  }\r\n\r\n  if (data.email && !validateEmail(data.email)) {\r\n    return { valid: false, message: \"Valid email is required\", field: \"email\" };\r\n  }\r\n\r\n  if (data.mobile && !validateMobile(data.mobile)) {\r\n    return { valid: false, message: \"Valid mobile is required\", field: \"mobile\" };\r\n  }\r\n\r\n  if (data.status && ![\"ACTIVE\", \"INACTIVE\", \"SUSPENDED\"].includes(data.status)) {\r\n    return { valid: false, message: \"Invalid status value\", field: \"status\" };\r\n  }\r\n\r\n  return { valid: true };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 702, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/responses.ts"],"sourcesContent":["// lib/responses.ts - Standardized API responses\r\n\r\nexport interface ApiResponseSuccess<T> {\r\n  success: boolean;\r\n  message: string;\r\n  data: T;\r\n}\r\n\r\nexport interface ApiResponseError {\r\n  success: boolean;\r\n  message: string;\r\n  error: string;\r\n  code?: string;\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n  success: boolean;\r\n  data: T[];\r\n  pagination: {\r\n    currentPage: number;\r\n    pageSize: number;\r\n    totalElements: number;\r\n    totalPages: number;\r\n    hasNext: boolean;\r\n    hasPrevious: boolean;\r\n  };\r\n}\r\n\r\n/**\r\n * Create a success response\r\n */\r\nexport function createSuccessResponse<T>(\r\n  message: string,\r\n  data: T,\r\n): ApiResponseSuccess<T> {\r\n  return {\r\n    success: true,\r\n    message,\r\n    data,\r\n  };\r\n}\r\n\r\n/**\r\n * Create an error response\r\n */\r\nexport function createErrorResponse(\r\n  message: string,\r\n  error: string,\r\n  code?: string,\r\n): ApiResponseError {\r\n  return {\r\n    success: false,\r\n    message,\r\n    error,\r\n    code,\r\n  };\r\n}\r\n\r\n/**\r\n * Create a paginated response\r\n */\r\nexport function createPaginatedResponse<T>(\r\n  message: string,\r\n  items: T[],\r\n  currentPage: number,\r\n  pageSize: number,\r\n  totalElements: number,\r\n): PaginatedResponse<T> & { message: string } {\r\n  const totalPages = Math.ceil(totalElements / pageSize);\r\n\r\n  return {\r\n    success: true,\r\n    message,\r\n    data: items,\r\n    pagination: {\r\n      currentPage,\r\n      pageSize,\r\n      totalElements,\r\n      totalPages,\r\n      hasNext: currentPage < totalPages,\r\n      hasPrevious: currentPage > 1,\r\n    },\r\n  } as any;\r\n}\r\n"],"names":[],"mappings":"AAAA,gDAAgD;;;;;;;;;AA+BzC,SAAS,sBACd,OAAe,EACf,IAAO;IAEP,OAAO;QACL,SAAS;QACT;QACA;IACF;AACF;AAKO,SAAS,oBACd,OAAe,EACf,KAAa,EACb,IAAa;IAEb,OAAO;QACL,SAAS;QACT;QACA;QACA;IACF;AACF;AAKO,SAAS,wBACd,OAAe,EACf,KAAU,EACV,WAAmB,EACnB,QAAgB,EAChB,aAAqB;IAErB,MAAM,aAAa,KAAK,IAAI,CAAC,gBAAgB;IAE7C,OAAO;QACL,SAAS;QACT;QACA,MAAM;QACN,YAAY;YACV;YACA;YACA;YACA;YACA,SAAS,cAAc;YACvB,aAAa,cAAc;QAC7B;IACF;AACF","debugId":null}},
    {"offset": {"line": 746, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/lib/errors.ts"],"sourcesContent":["// lib/errors.ts - Custom error classes\r\n\r\nexport class ApiError extends Error {\r\n  constructor(\r\n    public message: string,\r\n    public status: number = 400,\r\n    public code?: string,\r\n  ) {\r\n    super(message);\r\n    this.name = \"ApiError\";\r\n  }\r\n}\r\n\r\nexport class ValidationError extends ApiError {\r\n  constructor(message: string, public field?: string) {\r\n    super(message, 400, \"VALIDATION_ERROR\");\r\n    this.name = \"ValidationError\";\r\n  }\r\n}\r\n\r\nexport class NotFoundError extends ApiError {\r\n  constructor(message: string) {\r\n    super(message, 404, \"NOT_FOUND\");\r\n    this.name = \"NotFoundError\";\r\n  }\r\n}\r\n\r\nexport class UnauthorizedError extends ApiError {\r\n  constructor(message: string = \"Unauthorized\") {\r\n    super(message, 401, \"UNAUTHORIZED\");\r\n    this.name = \"UnauthorizedError\";\r\n  }\r\n}\r\n\r\nexport class ForbiddenError extends ApiError {\r\n  constructor(message: string = \"Forbidden\") {\r\n    super(message, 403, \"FORBIDDEN\");\r\n    this.name = \"ForbiddenError\";\r\n  }\r\n}\r\n\r\nexport class ConflictError extends ApiError {\r\n  constructor(message: string) {\r\n    super(message, 409, \"CONFLICT\");\r\n    this.name = \"ConflictError\";\r\n  }\r\n}\r\n\r\nexport class InternalServerError extends ApiError {\r\n  constructor(message: string = \"Internal Server Error\") {\r\n    super(message, 500, \"INTERNAL_SERVER_ERROR\");\r\n    this.name = \"InternalServerError\";\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,uCAAuC;;;;;;;;;;;;;;;;;AAEhC,MAAM,iBAAiB;;;;IAC5B,YACE,AAAO,OAAe,EACtB,AAAO,SAAiB,GAAG,EAC3B,AAAO,IAAa,CACpB;QACA,KAAK,CAAC,eAJC,UAAA,cACA,SAAA,aACA,OAAA;QAGP,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,wBAAwB;;IACnC,YAAY,OAAe,EAAE,AAAO,KAAc,CAAE;QAClD,KAAK,CAAC,SAAS,KAAK,0BADc,QAAA;QAElC,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,sBAAsB;IACjC,YAAY,OAAe,CAAE;QAC3B,KAAK,CAAC,SAAS,KAAK;QACpB,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,0BAA0B;IACrC,YAAY,UAAkB,cAAc,CAAE;QAC5C,KAAK,CAAC,SAAS,KAAK;QACpB,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,uBAAuB;IAClC,YAAY,UAAkB,WAAW,CAAE;QACzC,KAAK,CAAC,SAAS,KAAK;QACpB,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,sBAAsB;IACjC,YAAY,OAAe,CAAE;QAC3B,KAAK,CAAC,SAAS,KAAK;QACpB,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,4BAA4B;IACvC,YAAY,UAAkB,uBAAuB,CAAE;QACrD,KAAK,CAAC,SAAS,KAAK;QACpB,IAAI,CAAC,IAAI,GAAG;IACd;AACF","debugId":null}},
    {"offset": {"line": 813, "column": 0}, "map": {"version":3,"sources":["file:///D:/G/Aerocity/AEROCITY-FE/Aerocity/app/api/admin/offers/route.ts"],"sourcesContent":["// app/api/admin/offers/route.ts - Admin offer management\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/db\";\r\nimport { withAuth } from \"@/lib/auth-middleware\";\r\nimport { validateOfferRequest } from \"@/lib/validators\";\r\nimport { createSuccessResponse, createErrorResponse, createPaginatedResponse } from \"@/lib/responses\";\r\nimport { ValidationError, ForbiddenError } from \"@/lib/errors\";\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { auth, error } = await withAuth(request);\r\n    if (error) return error;\r\n\r\n    if (auth?.role !== \"ADMIN\") {\r\n      throw new ForbiddenError(\"Only admins can access this resource\");\r\n    }\r\n\r\n    const searchParams = request.nextUrl.searchParams;\r\n    const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\r\n    const pageSize = parseInt(searchParams.get(\"pageSize\") || \"10\", 10);\r\n    const activeOnly = searchParams.get(\"activeOnly\") === \"true\";\r\n    const ticketId = searchParams.get(\"ticketId\");\r\n\r\n    const where: any = {};\r\n    if (activeOnly) {\r\n      where.isActive = true;\r\n    }\r\n\r\n    if (ticketId) {\r\n      where.offerPrices = {\r\n        some: {\r\n          ticketId: parseInt(ticketId, 10),\r\n        },\r\n      };\r\n    }\r\n\r\n    const total = await prisma.offer.count({ where });\r\n\r\n    const offers = await prisma.offer.findMany({\r\n      where,\r\n      include: {\r\n        offerPrices: {\r\n          include: {\r\n            ticket: true,\r\n          },\r\n        },\r\n      },\r\n      skip: (page - 1) * pageSize,\r\n      take: pageSize,\r\n      orderBy: { createdAt: \"desc\" },\r\n    });\r\n\r\n    return NextResponse.json(\n      createPaginatedResponse(\n        \"Offers retrieved successfully\",\n        offers,\n        page,\n        pageSize,\n        total,\n      ),\n      { status: 200 },\n    );\n  } catch (error: any) {\r\n    console.error(\"Get offers error:\", error);\r\n\r\n    if (error instanceof ForbiddenError) {\r\n      return NextResponse.json(\r\n        createErrorResponse(\"Forbidden\", error.message),\r\n        { status: 403 },\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n      createErrorResponse(\"Failed to retrieve offers\", error.message),\r\n      { status: 500 },\r\n    );\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { auth, error } = await withAuth(request);\r\n    if (error) return error;\r\n\r\n    if (auth?.role !== \"ADMIN\") {\r\n      throw new ForbiddenError(\"Only admins can create offers\");\r\n    }\r\n\r\n    const body = await request.json();\r\n    validateOfferRequest(body);\r\n\r\n    const { name, description, startDate, endDate, isActive, offerPrices } = body;\r\n\r\n    // Create offer with offer prices\r\n    const offer = await prisma.offer.create({\r\n      data: {\r\n        name,\r\n        description: description || null,\r\n        startDate: new Date(startDate),\r\n        endDate: new Date(endDate),\r\n        isActive: isActive !== undefined ? isActive : true,\r\n        appliesToAllCustomers: true,\r\n        offerPrices: {\r\n          create: offerPrices.map((price: any) => ({\r\n            ticketId: price.ticketId,\r\n            offerPrice: price.offerPrice,\r\n          })),\r\n        },\r\n      },\r\n      include: {\r\n        offerPrices: {\r\n          include: {\r\n            ticket: true,\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    return NextResponse.json(\r\n      createSuccessResponse(\"Offer created successfully\", offer),\r\n      { status: 201 },\r\n    );\r\n  } catch (error: any) {\r\n    console.error(\"Create offer error:\", error);\r\n\r\n    if (error instanceof ForbiddenError) {\r\n      return NextResponse.json(\r\n        createErrorResponse(\"Forbidden\", error.message),\r\n        { status: 403 },\r\n      );\r\n    }\r\n\r\n    if (error instanceof ValidationError) {\r\n      return NextResponse.json(\r\n        createErrorResponse(\"Validation failed\", error.message),\r\n        { status: 400 },\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n      createErrorResponse(\"Failed to create offer\", error.message),\r\n      { status: 500 },\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}